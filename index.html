<!DOCTYPE html>
<html lang="en">
<head>
    <title>Test Case: Shadow DOM with Sticky Layout</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* Basic setup to lock the main page and prevent its scrollbar */
        html, body {
            height: 100%;
            margin: 0;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        /* The custom element that will host the shadow DOM needs to fill the whole page */
        scroll-component {
            display: block;
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>

    <scroll-component></scroll-component>

    <script>
        // --- This script defines the custom element that creates the Shadow DOM ---

        class ScrollComponent extends HTMLElement {
            constructor() {
                super();

                // 1. Create a shadow root. This isolates the component's internal DOM.
                const shadow = this.attachShadow({ mode: 'open' });

                // 2. Define the styles for the *internal* layout and scrolling container.
                const style = document.createElement('style');
                style.textContent = `
                    .page-container {
                        display: flex;
                        flex-direction: column;
                        height: 100%;
                    }
                    .header, .footer {
                        flex-shrink: 0;
                        background-color: #003366;
                        color: white;
                        padding: 1rem;
                        text-align: center;
                        z-index: 10;
                    }
                    /* This is the element that gets the scrollbar */
                    .content-area {
                        flex-grow: 1;
                        overflow-y: auto;
                        padding: 1.5rem;
                    }
                `;

                // 3. Create the internal HTML structure.
                const container = document.createElement('div');
                container.setAttribute('class', 'page-container');
                container.innerHTML = `
                    <header class="header">
                        <h2>Sticky Header</h2>
                    </header>
                    <main class="content-area">
                        <h3>This content is inside a Shadow DOM.</h3>
                        <p>The scrollbar you see on the right belongs to this middle section, which is isolated from the main page.</p>
                        <p>A 'scroll' listener on the main document will NOT fire.</p>
                        <p>${'This is a long line of text to ensure there is plenty of content to scroll through. '.repeat(500)}</p>
                    </main>
                    <footer class="footer">
                        <p>Sticky Footer</p>
                    </footer>
                `;

                // 4. Attach the styles and HTML to the shadow root.
                shadow.appendChild(style);
                shadow.appendChild(container);
            }
        }

        // 5. Register the new custom element.
        customElements.define('scroll-component', ScrollComponent);

        // This listener on the main document will FAIL to detect the scroll.
        document.addEventListener('scroll', () => {
            console.log("‚ùå FAILED: Scroll event detected on the main document.");
        }, true);
    </script>

</body>
</html>
